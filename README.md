# qlkube

qlkube is a graphql api for kubernetes, allowing you to interact with all the features of the Kubernetes api using graphql.

qlkube's graphql schema is dynamically built from the openapi/swagger api specification exposed by the Kubernetes cluster it 
is running in - qlkube should therefore:
    - expose *all* the types and operations from the Kubernetes rest api in its grapqhl api
    - be consistent with the exact Kubernetes api version of your cluster and kept up to date if and when this changes

In addition to the directly mapped operations from the openapi spec, qlkube provides an 'all' query type that gives a more
natural 'kubectl' influenced interface into the api.


## Example Queries

The 'all' resource is the easiest query type to use for querying kubernetes resources of all types (services, pods, deployments etc).
qlkube also exposes all the low-level resources autogenerated from the Kubernetes openapi/swagger api - these types are 
named exactly as the 'operationId' in the openapiSpec, they can therefore seem quite 'low-level' and sometimes unintuitive in comparison. 

<details>
 <summary>Get all pods in all namespaces</summary>
 
 This query returns the names and namespaces of all the pods in the cluster.
 (here we use the more friendly 'all' type - you can perform a similar query using 'listCoreV1PodForAllNamespaces')
 
```graphql
query getAllPodsInAllNamespaces {
  all {
    pods {
      items {
        metadata {
          name
          namespace
        }
      }
    }
  }
}
```
</details> 

<details>
 <summary>Get all pods in a specific namespace</summary>
 
 This query returns the names, namespaces, creation times and labels of all the pods in the 'default' namespace
 (here we use the more friendly 'all' type - you can perform a similar query using 'ioK8sApiCoreV1PodList')
 
```graphql
query getAllPodsInDefaultNamespace {
  all(namespace: "default") {
    pods {
      items {
        metadata {
          name
          namespace
          creationTimestamp
          labels
        }
      }
    }
  }
}
```
</details> 


<details>
 <summary>Get all kubernetes resources with a specific label</summary>

This query gets all kubernetes resources that are labelled with label 'app=alpha' 
(roughly equivalent to `kubectl get all -l app=alpha`)

```graphql
query allResourcesOfApp {
  all(labelSelector:"app=alpha") { 
    services {
      items {
        metadata {
          name
        }
      }
    }
    deployments {
      items {
        metadata {
          name
        }
      }
    }
    pods {
      items {
        metadata {
          name
        }
      }
    }
    daemonSets {
      items {
        metadata {
          name
        }
      }
    }
    replicaSets {
      items {
        metadata {
          name
        }
      }
    }
    statefulSets {
      items {
        metadata {
          name
        }
      }
    }
    jobs {
      items {
        metadata {
          name
        }
      }
    }
    cronJobs {
      items {
        metadata {
          name
        }
      }
    }  
  }
}
```
</details> 


